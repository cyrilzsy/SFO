<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Staple Food Ordinance</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css">
<style>
 body {
	padding-top: 5px;
   padding-left: 5px;
   padding-right: 5px;
}
.slidecontainer {
    width: 100%;
}
</style>
  <script src="https://cdn.bootcss.com/jquery/2.1.1/jquery.min.js"></script>
  <script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>

<div style="position:absolute; height:400px; overflow:auto"></div>

<div class="navbar navbar-default" style="background-color: #32383e;width: auto; height: auto">
  <div class="panel-heading">
<h1 style="color: white">Staple Food Ordinance Model <small>Web App Ver. 01</small></h1>
    </div>
</div>

<div class="panel panel-success">
    <div class="panel-heading" style="padding-top: 15px">
        <h3 class="panel-title" style="font-size: 30px;">1. Initialize</h3>
    </div>
    <div class="panel-body">
      <div style="padding-top: 10px; padding-bottom: 15px">
      <button id="button1" type="button" class="btn btn-primary btn-lg" style="font-size: 30px; text-shadow: black 5px 3px 3px">
        <span class="glyphicon glyphicon-off"></span> Click to Start
      </button>
      <button id="button2" type="button" class="btn btn-default btn-lg" style="font-size: 30px; text-shadow: gray 3px 3px 3px">
        <span class="glyphicon glyphicon-refresh"></span> Click to Reset
      </button>
      </div>
    </div>
</div>

<div class="panel panel-success">
    <div class="panel-heading" style="padding-top: 15px">
        <h3 class="panel-title" style="font-size: 30px;">2. Choose A Food</h3>
    </div>
    <div class="panel-body">
      <div class="btn-toolbar" role="toolbar">
        <div class="dropdown" style="padding-right: 10px">
          <button type="button" class="btn dropdown-toggle" id="dropdownMenu1" data-toggle="dropdown">
            <span class="	glyphicon glyphicon-th-list"></span>
            Fruits & Vegetables
          </button>
			    <ul class="dropdown-menu">
				    <li><a href=""><span class="glyphicon glyphicon-leaf"></span>Banana</a></li>
            <li><a href=""><span class="glyphicon glyphicon-leaf"></span>Frozen Vegetables</a></li>
			    </ul>
        </div>

        <div class="dropdown" style="padding-right: 10px">
          <button type="button" class="btn dropdown-toggle" id="dropdownMenu2" data-toggle="dropdown">
            <span class="	glyphicon glyphicon-th-list"></span>
            Drinks
          </button>
			    <ul class="dropdown-menu">
				    <li><a href=""><span class="glyphicon glyphicon-leaf"></span>Fat Free Milk</a></li>
			    </ul>
        </div>

        <div class="dropdown" style="padding-right: 10px">
          <button type="button" class="btn dropdown-toggle" id="dropdownMenu3" data-toggle="dropdown">
            <span class="	glyphicon glyphicon-th-list"></span>
            Protain
          </button>
			    <ul class="dropdown-menu">
				    <li><a href=""><span class="glyphicon glyphicon-leaf"></span>Banana</a></li>
				    <li><a href=""><span class="glyphicon glyphicon-leaf"></span>100% Whole Wheat Bread</a></li>
				    <li><a href=""><span class="glyphicon glyphicon-leaf"></span>Fat Free Milk</a></li>
            <li><a href=""><span class="glyphicon glyphicon-leaf"></span>Frozen Vegetables</a></li>
            <li><a href=""><span class="glyphicon glyphicon-leaf"></span>Low-Sodium Canned Beans</a></li>
			    </ul>
        </div>

        <div class="dropdown" style="padding-right: 10px">
          <button type="button" class="btn dropdown-toggle" id="dropdownMenu4" data-toggle="dropdown">
            <span class="	glyphicon glyphicon-th-list"></span>
            Bread
          </button>
			    <ul class="dropdown-menu">
				    <li><a href=""><span class="glyphicon glyphicon-leaf"></span>100% Whole Wheat Bread</a></li>
			    </ul>
        </div>

        <div class="dropdown" style="padding-right: 10px">
          <button type="button" class="btn dropdown-toggle" id="dropdownMenu5" data-toggle="dropdown">
            <span class="	glyphicon glyphicon-th-list"></span>
            Beans
          </button>
			    <ul class="dropdown-menu">
            <li><a href=""><span class="glyphicon glyphicon-leaf"></span>Low-Sodium Canned Beans</a></li>
			    </ul>
        </div>
      </div>
    </div>
</div>

<div class="panel panel-success">
    <div class="panel-heading" style="padding-top: 15px">
        <h3 class="panel-title" style="font-size: 30px;">3. Parameters Settings</h3>
    </div>
    <div class="panel-body">
      <div class="row">
        <div class="col-sm-4">
          <div class="panel panel-danger">
            <div class="panel-heading" style="padding-top: 5px">
              <h4 class="panel-title">Ordinance Characteristics</h4>
            </div>
            <div class="panel-body">

              <div class="slidecontainer">
              <p>Level of Enforcement:</p>
              <input type="range" min="1" max="100" value="50" id="Slider1"> <p style="pull">Value: <span id="SliderValue1"></span></p>
              </div>

              <div class="slidecontainer">
              <p>Promotions to Corner Store Owners:</p>
              <input type="range" min="1" max="100" value="50" id="Slider2"> <p>Value: <span id="SliderValue2"></span></p>
              </div>

              <div class="slidecontainer">
              <p>Promotions to Consumers:</p>
              <input type="range" min="1" max="100" value="50" id="Slider3"> <p>Value: <span id="SliderValue3"></span></p>
              </div>

              <div class="slidecontainer">
              <p>Minimum Stock Required:</p>
              <input type="range" min="1" max="100" value="50" id="Slider4"> <p>Value: <span id="SliderValue4"></span></p>
              </div>

            </div>
          </div>
        </div>



        <div class="col-sm-4">
          <div class="panel panel-warning">
            <div class="panel-heading" style="padding-top: 5px">
              <h4 class="panel-title">Demand (Consumers)</h4>
            </div>
            <div class="panel-body">

              <div class="slidecontainer">
              <p>Convenience of Preparation:</p>
              <input type="range" min="1" max="100" value="50" id="Slider5"> <p>Value: <span id="SliderValue5"></span></p>
              </div>

              <div class="slidecontainer">
              <p>Taste:</p>
              <input type="range" min="1" max="100" value="50" id="Slider6"> <p>Value: <span id="SliderValue6"></span></p>
              </div>

              <div class="slidecontainer">
              <p>Affordability:</p>
              <input type="range" min="1" max="100" value="50" id="Slider7"> <p>Value: <span id="SliderValue7"></span></p>
              </div>

              <div class="slidecontainer">
              <p>Healthiness:</p>
              <input type="range" min="1" max="100" value="50" id="Slider8"> <p>Value: <span id="SliderValue8"></span></p>
              </div>

            </div>
          </div>
        </div>


        <div class="col-sm-4">
          <div class="panel panel-info">
            <div class="panel-heading" style="padding-top: 5px">
              <h4 class="panel-title">Supply (Retail Food Store)</h4>
            </div>
            <div class="panel-body">

              <div class="slidecontainer">
              <p>Infrastructure (Storage) Capacity:</p>
              <input type="range" min="1" max="100" value="50" id="Slider9"> <p>Value: <span id="SliderValue9"></span></p>
              </div>

              <div class="slidecontainer">
              <p>Ease of Delivery:</p>
              <input type="range" min="1" max="100" value="50" id="Slider10"> <p>Value: <span id="SliderValue10"></span></p>
              </div>

              <div class="slidecontainer">
              <p>Unit Cost:</p>
              <input type="range" min="1" max="100" value="50" id="Slider11"> <p>Value: <span id="SliderValue11"></span></p>
              </div>

              <div class="slidecontainer">
              <p>Optimal Price on hand:</p>
              <input type="range" min="1" max="100" value="50" id="Slider12"> <p>Value: <span id="SliderValue12"></span></p>
              </div>

            </div>
          </div>
        </div>
      </div>

    </div>
</div>

<div class="panel panel-success">
    <div class="panel-heading" style="padding-top: 15px">
        <h3 class="panel-title" style="font-size: 30px;">4. Results</h3>
    </div>
    <div class="panel-body">
      <div class="row">

        <div class="col-sm-4">
          <div id="plot1"></div>
        </div>

        <div class="col-sm-4">
          <div id="plot2"></div>
        </div>

        <div class="col-sm-4">
          <div id="plot3"></div>
        </div>
      </div>

      <div class="row">
        <div class="col-sm-4">
          <div id="plot4"></div>
        </div>

        <div class="col-sm-4">
          <div id="plot5"></div>
        </div>

        <div class="col-sm-4">
          <div id="plot6"></div>
        </div>
      </div>

      <div class="row">
        <div class="col-sm-4">
          <div id="plot7"></div>
        </div>
      </div>

    </div>
</div>

<script>
var Sliders = ["Slider1","Slider2","Slider3","Slider4","Slider5","Slider6","Slider7","Slider8","Slider9","Slider10","Slider11","Slider12"];
var SliderValues = ["SliderValue1","SliderValue2","SliderValue3","SliderValue4","SliderValue5","SliderValue6","SliderValue7","SliderValue8","SliderValue9","SliderValue10","SliderValue11","SliderValue12"];
var i;
var slider = [];
var output = [];

var xValue = ['Product A', 'Product B', 'Product C'];

var yValue = [];

var trace1 = {
  x: xValue,
  y: yValue,
  type: 'bar',
  text: yValue,
  textposition: 'auto',
  hoverinfo: 'none',
  marker: {
    color: 'rgb(158,202,225)',
    opacity: 0.6,
    line: {
      color: 'rbg(8,48,107)',
      width: 1.5
    }
  }
};

var data = [trace1];

var layout = {
  title: 'January 2013 Sales Report'
};

var t_max = 100;
var Enforcement;
var Training;
var Signage;
var Convenience;
var Taste;
var Affordability;
var Healthiness;
var S_infra;
var S_required;
var X_delivery;
var C_store;
var C_cust;
var Par = [0.1511,-0.0352,0.1864,-0.0352,3,0.14,0.18,0.15,0.18,0.17,0.13,3.875,0.4550,0.0104,-0.0323,1];

var S_actual = [];
var Y_supply = [];
var Y_cust = [];
var Y_waste = [];
var Y_demand = [];
var M_profit = [];
var M_storage = [];
var M_supply = [];
var M_delivery = [];
var M_cust = [];

function runTime(Enforcement,Training,Signage,Convenience,Taste,Affordability,Healthiness,S_infra,S_required,X_delivery,C_store,C_cust,Par) {
  C_delivery = Par[0] + X_delivery * Par[1];
  C_storage = Par[2] + Par[3] * S_infra;
  C_total = C_delivery + C_storage + C_store;

  for (i=0; i<t_max; i++) {
    Y_supply[i] = Math.max(S_required * Enforcement - S_actual[i-1],0,Y_demand[i-1] - S_actual[i-1]);
    S_actual[i] = Y_supply[i] + S_actual[i-1];
    Y_demand[i] = Par[4] + Par[5]*Training + Par[6] * Signage + Par[7] * Convenience + Par[8] * Taste + Par[9] *Affordability + Par[10] * Healthiness - Par[11] * (C_cust);
    Y_cust[i] = Math.min(Y_demand[i],S_actual[i]);
    Y_waste[i] = Math.max(S_actual[i] * Par[15] - Y_cust[i],0);
    S_actual[i] = S_actual[i] - Y_cust[i] - Y_waste[i];
    M_supply[i] = Y_supply[i] * C_store;
    M_storage[i] = C_storage * S_actual[i];
    M_delivery[i] = C_delivery * Y_supply[i];
    M_cust[i] = C_cust * Y_cust[i];
    M_profit[i] = M_cust[i] - M_delivery[i] - M_storage[i] - M_supply[i];
  }
  return [Y_cust,Y_demand,Y_supply,Y_waste,S_actual,M_profit,M_storage,M_supply,M_delivery,M_cust];
}



function updatePlot1(values) {
  yValue[0] = values;
  yValue[1] = 10;
  Plotly.newPlot('plot1', data, layout);
}

for (i=0; i < Sliders.length; i++) {
  slider[i] = document.getElementById(Sliders[i]);
  output[i] = document.getElementById(SliderValues[i]);
  output[i].innerHTML = slider[i].value;                   // initialize
  slider[i].oninput = (function(e) {
    return function() {

      output[e].innerHTML = this.value;


      Enforcement = slider[0].value;
      Training = slider[1].value;
      Signage = slider[2].value;
      Convenience = slider[4].value;
      Taste = slider[5].value;
      Affordability = slider[6].value;
      Healthiness = slider[7].value;
      S_infra = slider[8].value;
      S_required = slider[3].value;
      X_delivery = slider[9].value;
      C_store = slider[10].value;
      C_cust = slider[11].value;
      Par = [0.1511, -0.0352, 0.1864, -0.0352, 3, 0.14, 0.18, 0.15, 0.18, 0.17, 0.13, 3.875, 0.4550, 0.0104, -0.0323, 1];
      timeResult = runTime(Enforcement,Training,Signage,Convenience,Taste,Affordability,Healthiness,S_infra,S_required,X_delivery,C_store,C_cust,Par);
      console.log(timeResult[0]);
      updatePlot1(timeResult[0][99]);

    }
    })(i);                                                  // (i) is the argument, passed to (e)
}

// Plotly.newPlot('plot1', data, layout);
</script>

<script src="https://cdn.bootcss.com/jquery/2.1.1/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
</body>
</html>
